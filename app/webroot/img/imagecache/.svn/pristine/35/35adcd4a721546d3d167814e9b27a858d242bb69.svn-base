$(function() {	$.validateForm = function(form) {		var self = this;		var mode = $(form).data('mode');		var trial = $(form).data('trial');		var step = $(form).data('step');		this.onSubmitForm = function() {			$(form).submit(function(e) {								var trial = $(form).data('trial');				var step = $(form).data('step');								// if step 1 is valid move to step 2				if ( trial == 'trial' && step == 'step1' && self.isFormValid(form) ) {										$('div.error-message').removeClass('me_hide');										$('#14-day-free-trial').hide().addClass('me_hide');					$('#14-day-free-trial-cc').show().removeClass('me_hide');										$(form).data('step','step2');										$('#filocity_registration_no_cc_form').addClass('step2');					$('#filocity_registration_no_cc_form_wrapper').addClass('step2');											// prevent submission until step 2 is done					e.preventDefault();									} else if (!self.isFormValid(form)) {					// if any step invalid prevent default					e.preventDefault();									$('div.error-message').removeClass('me_hide');				} else {					return true;				}							});		};				this.refreshInputOnType = function() {			this.onSubmitForm();			$('body').on('keyup focusout', form + ' input.required', function() {				var value = $.trim(this.value),				type = this.name,				validate_email=/^([a-z0-9._%+-]+)\@([a-z0-9-]+\.)+([a-z0-9]{2,4})$/i,				input = this;								if(value) {					if(type == 'data[User][email]' && !validate_email.test(value)) {						$(this).addClass('error');					} else if(type == 'data[User][email]' && validate_email.test(value)) {						$(this).removeClass('error');						// Check email exists only for add info						// not for edit info						if(mode != 'edit') {							self.checkEmailAlreadyUsed(input);						}					} else {						$(this).removeClass('error');					}				} else {					$(this).addClass('error');				}				if( self.isFormValid(form)) {					$('.member_info_form_buttons').removeClass('me_hide');					//$(form + ' div.submit').show(0);				} else {					$('.member_info_form_buttons').addClass('me_hide');					//$(form + ' div.submit').hide(0);				}			});		};		this.checkEmailAlreadyUsed = function(input) {			$.post(_ROOT + 'users/is_user_exists', {'data[User][email]' : input.value}, function(response) {				if(response.status == 'y') {					$(input).val('').addClass('error').prop('placeholder', 'Email already used.');				}			}, 'json');		};		this.isFormValid = function(form) {						var mode = $(form).data('mode');			var trial = $(form).data('trial');			var step = $(form).data('step');									if ( trial == 'trial' && step == 'step1' ) {				var isValid = $('#14-day-free-trial input.required', form).filter(function() {					return !$.trim(this.value);					}).length === 0;			} else if ( trial == 'trial' && step == 'step2' ){				var isValid = $('#14-day-free-trial-cc input.required', form).filter(function() {					return !$.trim(this.value);					}).length === 0;						} else if ( trial != 'trial' ) {								var isValid = $('input.required', form).filter(function() {					return !$.trim(this.value);					}).length === 0;						}			return isValid; 		};				this.refreshInputOnType();	};	$.validateForm('#UserRegistrationForm');});