$(function() {	/*	*	User list dropdown	*/	$.userSelectionList = function(handle) {		var handle = handle || '.handler_to_user_list',		to_decline = '<div class="selection_decline"><span class="selection_cancel">- cancel</span></div>',		ddo = '#directory_dd_options',		vm = '.the_visibility_modal',		dd = '#directory_dd',		add = '.selection_add',		cancel = 'span.cancel',		done = 'span.done',		dne = '#dates_and_events',		H = $(handle),		Fn = {			init: function() {				H.wrapInner('<div class="selection_add"/>');				Fn.attachEvents(['add', 'cancel', 'ddClick', 'ddOptClick', 'done']);			},			attachEvents: function(events) {				for(var i = 0; i < events.length; i++) {					Fn[events[i] + 'Event']();				}			},			addEvent: function() {				H.on('click', add, Fn.showList);			},			cancelEvent: function() {				$(dne).on('click', cancel, Fn.hideList);			},			ddClickEvent: function() {				$(dd).on({					click: function() {						$(ddo).slideToggle(200);						$(this).find('.dd_pointer').toggleClass('dd_pointer_up');					}				});			},			ddOptClickEvent: function() {				$('li', ddo).on({					click: function() {						var text = $('a', this).text(),						value = $('input:hidden', this).val();						$('.dd_select').html(text);						$('input.selected_category').val(value);						$('.err_msg').css('visibility', 'hidden');						Fn.hideOptionsList();					}				});			}, 			doneEvent : function() {				$(dne).on('click', done, Fn.addUserToCalendar);			},			hideOptionsList: function(cb) {				$(ddo + ':visible').slideUp(200,				function() {					$(dd).find('.dd_pointer').removeClass('dd_pointer_up');					return cb;				});			},			showList: function(e) {				if( $('li', ddo).length) {					$(vm).slideToggle(200);					Fn.hideOptionsList();				} else {					alert('No member to add.');				}			},			hideList: function(e) {				Fn.hideOptionsList();				$(vm).slideUp(200);			},			addCalendar: function(data, callback) {				$.ajax({					url: _ROOT + 'calendar_adds/add',					type: 'POST',					data: data,					dataType: 'json'				}).done(function(response) {					callback(response);				});			},			addUserToCalendar: function() {				var selected = $('input.selected_category').val();				$('.err_msg').css('visibility', 'hidden');				if(!selected) {					$('.err_msg').css('visibility', 'visible');					return false;				}				Fn.hideList();				Fn.addCalendar({					'data[CalendarAdd][user_id]' : $('input.auth_id').val(),					'data[CalendarAdd][user_add]' : $('input.selected_category').val()				}, function(response) {					if(response.exist) {						alert('Already added that user');					} else if(response.status == 'y') {						//$.miniCalendar().redraw();						window.location.reload();					}				});			}		};		Fn.init();	};		/*	*	Show User selection list	*/		$.userSelectionList();	});